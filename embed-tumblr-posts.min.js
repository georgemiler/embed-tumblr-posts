/*
 MIT License
*/
(function(f,i){var c=f.window,e;if(!(e=f.EmbedTumblrPosts))e=function a(d,b){b=b||{};this.settings=g.objectMerge(a.DEFAULT_SETTINGS,b);this.targetElement=d;if(!(d instanceof Element))throw new TypeError("This class is required argument targetElement.");this.contextNode=d.ownerDocument},e.prototype.constructor=e,e.DEFAULT_SETTINGS={api_key:null,"base-hostname":"example.com",limit:10,offset:0},e.prototype.run=function(){},f.EmbedTumblrPosts=e;var j=e,b=function(a){var a=b.getCurrentScriptElement(a),
d=g.objectMerge.apply(g,[b.parseEmbedSettingsText(a),b.parseQueryString(a)]);b.listener=b.createListener(a,d);b.addListener()};b.listener=function(){return i};b.addListener=function(){c.addEventListener("DOMContentLoaded",b.listener)};b.createListener=function(a,d){var b=new j(a,d);return function(a){b.run(a)}};b.getCurrentScriptElement=function(a){a=a.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","script");return a[a.length-1]};b.parseQueryString=function(a){a=a.getAttribute("src");a=(g.parseUri(a).search||
"?").slice(1);return g.parseQueryString(a)};b.parseEmbedSettingsText=function(a){a=g.extractContentsFromCdataSection(a.textContent);return JSON.parse(a)};var g={objectMerge:function(a){for(var d=arguments,b={},e=0,g=d.length,f,c;e<g;e++)for(c in f=d[e])b[c]=f[c];return b},parseUri:function(a){var d=document.createElementNS("http://www.w3.org/1999/xhtml","a");d.setAttribute("href",a);return d},parseQueryString:function(a){for(var d={},a=a.split(/[;&]/),b=0,e=a.length,c;b<e;b++)c=a[b].split("="),d[c[0]]=
c[1]||!0;return d},extractContentsFromCdataSection:function(a){a=a.replace(/^<!\[CDATA\[/,"");return a=a.replace(/\]\]>$/,"")},extractHtmlTags:function(a){return a=a.replace(/<.+?>/g,"")},escapeHtmlTags:function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")}};if(c===f){if("undefined"!==typeof c.navigator&&/MSIE/.test(c.navigator.userAgent)){var h=c.document;"function"!==typeof f.Window.prototype.addEventListener&&(f.Window.prototype.addEventListener=function(a,
b){var c=this,b=function(a){"onreadystatechange"===a.type&&"complate"!==this.readyState||b.call(c,a)};"DOMContentLoaded"!==a?h.attachEvent("onreadystatechange",b):this.attachEvent("on"+a,b)});"function"!==typeof h.createElementNS&&(h.createElementNS=function(a,b){return this.createElement(b)});"function"!==typeof h.getElementsByTagNameNS&&(h.getElementsByTagNameNS=function(a,b){return this.getElementsByTagName(b)});"string"!==typeof h.createElementNS("http://www.w3.org/1999/xhtml","div").textContent&&
"function"===typeof Object.defineProperty&&Object.defineProperty(Element.prototype,"textContent",{get:function(){return this.extractHtmlTags(this.innerHTML)},set:function(a){return this.innerHTML=g.escapeHtmlTags(a)},configurable:!0,enumerable:!1})}b(c.document)}})(this,void 0);
